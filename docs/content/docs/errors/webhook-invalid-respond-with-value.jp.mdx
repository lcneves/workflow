---
title: webhook-invalid-respondWith-値
---

このエラーは、webhook を作成する際に `respondWith` オプションに無効な値を指定した場合に発生します。`respondWith` オプションは `"manual"` または `Response` オブジェクトのいずれかである必要があります。

## エラーメッセージ

```
Invalid `respondWith` value: [value]
```

## なぜこれが起こるのか

`createWebhook()` で webhook を作成する際、`respondWith` オプションで受信した HTTP リクエストに対する webhook の応答方法を指定できます。このオプションが受け付ける値は次の通りです：

1. `"manual"` - ワークフロー内から手動でレスポンスを送信できるようにします
2. `Response` オブジェクト - 事前定義されたレスポンスを即座に送信するためのもの
3. `undefined`（デフォルト） - `202 Accepted` レスポンスを返します

## よくある原因

### 無効な文字列値を使用している

```typescript lineNumbers
// Error - invalid string value
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "automatic", // Error! // [!code highlight]
  });
}
```

**解決方法：** `"manual"` を使用するか `Response` オブジェクトを提供してください。

```typescript lineNumbers
// Fixed - use "manual"
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual", // [!code highlight]
  });

  const request = await webhook;

  // Send custom response
  await request.respondWith(new Response("OK", { status: 200 })); // [!code highlight]
}
```

### Response 以外のオブジェクトを使用している

```typescript lineNumbers
// Error - plain object instead of Response
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: { status: 200, body: "OK" }, // Error! // [!code highlight]
  });
}
```

**解決方法：** 適切な `Response` オブジェクトを作成してください。

```typescript lineNumbers
// Fixed - use Response constructor
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: new Response("OK", { status: 200 }), // [!code highlight]
  });
}
```

## 有効な使用例

### デフォルトの動作（202 Accepted レスポンス）

```typescript lineNumbers
// Returns 202 Accepted automatically
const webhook = await createWebhook();
const request = await webhook;
// No need to send a response
```

### 手動レスポンス

```typescript lineNumbers
// Manual response control
const webhook = await createWebhook({
  respondWith: "manual",
});

const request = await webhook;

// Process the request...
const data = await request.json();

// Send custom response
await request.respondWith(
  new Response(JSON.stringify({ success: true }), {
    status: 200,
    headers: { "Content-Type": "application/json" },
  })
);
```

### 事前定義されたレスポンス

```typescript lineNumbers
// Immediate response
const webhook = await createWebhook({
  respondWith: new Response("Request received", { status: 200 }),
});

const request = await webhook;
// Response already sent
```

## 詳しくは

- [createWebhook() API リファレンス](/docs/api-reference/workflow/create-webhook)
- [resumeWebhook() API リファレンス](/docs/api-reference/workflow-api/resume-webhook)
- [Webhooks ガイド](/docs/foundations/hooks)