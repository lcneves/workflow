---
title: réponse-webhook-non-envoyée
---

Cette erreur se produit lorsqu'un webhook est configuré avec `respondWith: "manual"` mais que le workflow n'envoie pas de réponse en utilisant `request.respondWith()` avant la fin de l'exécution du webhook.

## Message d'erreur

```
Workflow run did not send a response
```

## Pourquoi cela se produit

Lorsque vous créez un webhook avec `respondWith: "manual"`, vous êtes responsable d'appeler `request.respondWith()` pour renvoyer la réponse HTTP à l'appelant. Si l'exécution du workflow se termine sans envoyer de réponse, cette erreur sera levée.

L'infrastructure des webhooks attend qu'une réponse soit envoyée, et si aucune n'est fournie, elle ne peut pas compléter correctement la requête HTTP.

## Causes courantes

### Oublier d'appeler `request.respondWith()`

```typescript lineNumbers
// Error - no response sent
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual",
  });

  const request = await webhook;
  const data = await request.json();

  // Process data...
  console.log(data);

  // Error: workflow ends without calling request.respondWith() // [!code highlight]
}
```

**Solution :** Appelez toujours `request.respondWith()` lorsque vous utilisez le mode de réponse manuel.

```typescript lineNumbers
// Fixed - response sent
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual",
  });

  const request = await webhook;
  const data = await request.json();

  // Process data...
  console.log(data);

  // Send response before workflow ends // [!code highlight]
  await request.respondWith(new Response("Processed", { status: 200 })); // [!code highlight]
}
```

### Logique de réponse conditionnelle

```typescript lineNumbers
// Error - response only sent in some branches
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual",
  });

  const request = await webhook;
  const data = await request.json();

  if (data.isValid) {
    await request.respondWith(new Response("OK", { status: 200 }));
  }
  // Error: no response when data.isValid is false // [!code highlight]
}
```

**Solution :** Assurez-vous que tous les chemins d'exécution envoient une réponse.

```typescript lineNumbers
// Fixed - response sent in all branches
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual",
  });

  const request = await webhook;
  const data = await request.json();

  if (data.isValid) { // [!code highlight]
    await request.respondWith(new Response("OK", { status: 200 })); // [!code highlight]
  } else { // [!code highlight]
    await request.respondWith(new Response("Invalid data", { status: 400 })); // [!code highlight]
  } // [!code highlight]
}
```

### Exception avant la réponse

```typescript lineNumbers
// Error - exception thrown before response
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual",
  });

  const request = await webhook;

  // Error occurs here // [!code highlight]
  throw new Error("Something went wrong"); // [!code highlight]

  // Never reached
  await request.respondWith(new Response("OK", { status: 200 }));
}
```

**Solution :** Utilisez try-catch pour gérer les erreurs et envoyer des réponses appropriées.

```typescript lineNumbers
// Fixed - error handling with response
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook({
    respondWith: "manual",
  });

  const request = await webhook;

  try { // [!code highlight]
    // Process request...
    const result = await processData(request); // [!code highlight]
    await request.respondWith(new Response("OK", { status: 200 })); // [!code highlight]
  } catch (error) { // [!code highlight]
    // Send error response // [!code highlight]
    await request.respondWith( // [!code highlight]
      new Response("Internal error", { status: 500 }) // [!code highlight]
    ); // [!code highlight]
  } // [!code highlight]
}
```

## Alternative : utiliser le mode de réponse par défaut

Si vous n'avez pas besoin d'un contrôle personnalisé de la réponse, envisagez d'utiliser le mode de réponse par défaut qui renvoie automatiquement une réponse `202 Accepted` :

```typescript lineNumbers
// Automatic 202 response - no manual response needed
export async function webhookWorkflow() {
  "use workflow";

  const webhook = await createWebhook(); // [!code highlight]
  const request = await webhook;

  // Process request asynchronously
  await processData(request);

  // No need to call request.respondWith()
}
```

## En savoir plus

- [Référence API de createWebhook()](/docs/api-reference/workflow/create-webhook)
- [Référence API de resumeWebhook()](/docs/api-reference/workflow-api/resume-webhook)
- [Guide des webhooks](/docs/foundations/hooks)